<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spam Puisi Romantis - maoo_2553</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gradient-to-r from-pink-900 via-purple-900 to-indigo-900 min-h-screen text-white">
  <div class="max-w-xl mx-auto py-10 px-6">
    <h1 class="text-3xl font-bold text-center mb-6">Puisi Romantis Anonim</h1>
    <form id="puisiForm" class="bg-white bg-opacity-10 p-6 rounded-lg shadow-md">
      <div class="mb-4">
        <label class="block mb-1">Nama Target</label>
        <input type="text" id="targetName" class="w-full px-4 py-2 rounded bg-gray-800 text-white" placeholder="Masukkan nama" required>
      </div>
      <div class="mb-4">
        <label class="block mb-1">Jumlah Pesan</label>
        <input type="number" id="count" class="w-full px-4 py-2 rounded bg-gray-800 text-white" min="1" placeholder="Contoh: 5" required>
      </div>
      <div class="mb-4">
        <label class="block mb-1">Mode</label>
        <select id="mode" class="w-full px-4 py-2 rounded bg-gray-800 text-white">
          <option value="puisi">Puisi</option>
          <option value="kostum">Kostum</option>
        </select>
      </div>
      <div id="kostumWrapper" class="mb-4 hidden">
        <label class="block mb-1">Isi Pesan Kostum</label>
        <textarea id="customMessage" class="w-full px-4 py-2 rounded bg-gray-800 text-white" placeholder="Tulis pesan kostum..."></textarea>
      </div>
      <button type="submit" class="w-full bg-purple-600 py-2 rounded hover:bg-purple-700 transition">Kirim Pesan</button>
    </form>
  </div>  <script>
    const puisiList = [
      "Kamu seperti kopi pagi, menghangatkan hari tanpa basa-basi.",
      "Namamu adalah lagu, dan aku pemutar setia di dadaku.",
      "Matamu seperti senja, menenangkan tapi bikin lupa waktu.",
      "Dalam diamku, aku mengeja namamu dengan cinta.",
      "Kau adalah alasan mengapa malamku tidak pernah gelap.",
      "Cintamu seperti hujan pertama, dinanti dan dikenang selalu.",
      "Aku ingin jadi alasan kamu lupa mantan.",
      "Senyummu meruntuhkan semua argumen logika.",
      "Namamu kusebut dalam doa yang bahkan tak kuingat kapan kutulis.",
      "Cinta ini sederhana: kamu ada, aku bahagia."
    ];

    const form = document.getElementById("puisiForm");
    const modeSelect = document.getElementById("mode");
    const kostumWrapper = document.getElementById("kostumWrapper");

    modeSelect.addEventListener("change", () => {
      kostumWrapper.classList.toggle("hidden", modeSelect.value !== "kostum");
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("targetName").value.trim();
      const count = parseInt(document.getElementById("count").value);
      const mode = document.getElementById("mode").value;
      const kostum = document.getElementById("customMessage").value.trim();

      if (!name || isNaN(count) || count <= 0 || (mode === 'kostum' && !kostum)) {
        return Swal.fire("Error", "Isi semua kolom dengan benar.", "error");
      }

      Swal.fire({
        title: 'Mengirim Pesan...',
        html: `Mengirim ${count} pesan ke <b>${name}</b>`,
        didOpen: () => Swal.showLoading(),
        allowOutsideClick: false
      });

      let sukses = 0;
      let gagal = 0;

      for (let i = 0; i < count; i++) {
        const pesan = mode === "kostum" ? kostum : puisiList[Math.floor(Math.random() * puisiList.length)].replace(/kamu/gi, name);

        try {
          const res = await fetch("/api", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username: name, message: pesan })
          });
          res.ok ? sukses++ : gagal++;
        } catch {
          gagal++;
        }

        await new Promise(resolve => setTimeout(resolve, Math.random() * 1000 + 1000));
      }

      Swal.fire("Selesai!", `Berhasil: ${sukses}, Gagal: ${gagal}`, "success");
    });
  </script></body>
</html>
